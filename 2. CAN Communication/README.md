# CAN 통신 핵심 개념 정리

## 1. CAN 토폴로지와 전송 방식

### 버스 토폴로지 사용 이유
- **배선 복잡성 해결**: 여러 제어기를 하나의 공통된 선에 연결하여 배선 복잡성과 무게 감소
- **확장성**: 새로운 제어기 연결이나 제거가 용이함
- **브로드캐스트 방식**: 모든 노드가 동일한 데이터를 수신할 수 있음

<br>

## 2. 종단저항 (Termination Resistance)

### 120옴 저항의 목적
- **신호 반사 방지**: 버스 끝단에서 발생하는 전기 신호 반사를 흡수
- **신호 왜곡 방지**: 반사된 신호가 원래 신호와 중첩되어 발생하는 왜곡 방지
- **통신 품질 확보**: 안정적인 신호 전송을 위한 필수 요소
- **설치 위치**: CAN 버스의 양 끝단에 각각 하나씩 설치

<br>

## 3. CAN 신호 표현 방식

### Differential Signaling
- **구성**: CAN High와 CAN Low 두 선으로 구성
- **데이터 표현**: 두 선 간의 전압 차이로 비트 0과 1을 구분
  - **비트 0 (Dominant)**: CAN High - CAN Low = 양의 전압차
  - **비트 1 (Recessive)**: CAN High - CAN Low = 0V 또는 작은 전압차
- **장점**: 노이즈에 강함 (공통 모드 노이즈 제거)

<br>

## 4. CAN 하드웨어 구성

### CAN 트랜시버의 역할
- **신호 레벨 변환**: MCU 로직 레벨(0V/5V) ↔ CAN 버스 레벨(예: 1.25V/3.75V)
- **양방향 변환**: 송신 시 로직 레벨을 CAN 레벨로, 수신 시 CAN 레벨을 로직 레벨로 변환
- **CAN 컨트롤러와의 연동**: MCU 내부 CAN 컨트롤러와 물리적 CAN 버스 사이의 인터페이스

### CAN 컨트롤러
- **프로토콜 처리**: CAN 통신 프로토콜 관련 기능 담당
- **메시지 관리**: 메시지 송수신, 필터링, 에러 처리 등

<br>

## 5. 통신 속도 (BaudRate)

### 동일 BaudRate 필요성
- **비트 타이밍 동기화**: 모든 제어기가 동일한 비트 길이를 인지해야 함
- **정확한 샘플링**: 브로드캐스트 방식에서 모든 노드가 동시에 올바른 데이터 샘플링
- **네트워크 안정성**: 타이밍 불일치로 인한 통신 오류 방지

### BaudRate 구성 요소
- **TSEG1 (Time Segment 1)**: 동기화 후 샘플링 지점까지의 시간
- **TSEG2 (Time Segment 2)**: 샘플링 지점 후 비트 끝까지의 시간  
- **SJW (Synchronization Jump Width)**: 동기화 조정 범위

<br>

## 6. 실무 적용 사항

### 데이터시트 활용
- **TJA1043 트랜시버**: 실제 산업용 CAN 트랜시버 사양 분석
- **MCU 데이터시트**: BaudRate 설정을 위한 하드웨어 사양 확인
- **전기적 특성**: 전압 레벨, 타이밍 특성 등 실제 구현에 필요한 정보

### 설계 고려사항
- **네트워크 구성**: 노드 수, 케이블 길이에 따른 BaudRate 선택
- **신호 품질**: 종단저항, 케이블 임피던스 매칭
- **시스템 호환성**: 기존 시스템과의 BaudRate 호환성 확보